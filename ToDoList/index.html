<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TodoList</title>
    <link rel="stylesheet" type="text/css" href="./css/app.css"/>
    <link rel="stylesheet" type="text/css" href="./css/Header.css"/>
    <link rel="stylesheet" type="text/css" href="./css/editor.css"/>
    <link rel="stylesheet" type="text/css" href="./css/list.css"/>
    <link rel="stylesheet" type="text/css" href="./css/todoitem.css"/>
</head>
<body>
    <script>
        let mockData = [ 
      {id:0, isDone:false, content:"React study", date: new Date()}, 
      {id:1, isDone:true, content:"ì¹œêµ¬ë§Œë‚˜ê¸°", date: new Date()}, 
      {id:2, isDone:false, content:"ë‚®ì ìê¸°", date: new Date()}, 
      ];
      let day =["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];
        onload=()=>{
            initData(mockData);

        }
    const initData = (printData)=>{
        let items = document.querySelector(".todos_wrapper").innerHTML;
        items=``;
        console.log(printData.length);
        if(printData.length > items.length){
            
        }
       
       
        for(let i=0;i<printData.length;i++){   
            items += `<div class="TodoItem">
                <input type="checkbox" onchange="onUpdate(this.id)" id="item.id">
                <div class="content"></div>
                <div class="date"></div>
                <button class="button" onclick="todoDel(this)">ì‚­ì œ</button>
            </div>`;
        };

        document.querySelectorAll(".TodoItem").forEach((item,idx) => {
           if(mockData[idx].isDone)item.querySelector("input").checked=true;
           item.querySelector(".content").innerText = mockData[idx].content;
           let dateTime =mockData[idx].date;
           item.querySelector(".date").innerText = dateTime.getFullYear()+"."+dateTime.getMonth()+"."+dateTime.getDay()+"."+(dateTime.getHours()<12?'ì˜¤ì „':'ì˜¤í›„')+" "+dateTime.getHours()+":"+dateTime.getMinutes()+":"+dateTime.getSeconds();
        });
    }


    </script>
    <div class="App">
        <div class="Header">
            <h3>ì˜¤ëŠ˜ì˜ PlanğŸ˜Š</h3>
            <h1 id="current_date">
                <script>
                   let date = new Date();
                   let year = date.getFullYear();
                   let month = date.getMonth() + 1;
                   let days = date.getDate();
                    document.getElementById("current_date").innerHTML = year + "-" + month + "-" + days+" "+day[date.getDay()]+"ìš”ì¼";
                </script>
            </h1>       
        </div>
        <form>
            <div class="Editor">
                <input id="inputContent">
                <button>ì¶”ê°€</button> 

            </div>
        </form>
    

    <div class="List">
        <h4></h4>
        <input>
        <div class="todos_wrapper">
            <div class="TodoItem">
                <input type="checkbox" onchange="onUpdate(this.id)" id="0">
                <div class="content"></div>
                <div class="date"></div>
                <button class="button" onclick="todoDel(this)">ì‚­ì œ</button>
            </div>
            <div class="TodoItem">
                <input type="checkbox" onchange="onUpdate(this.id)" id="1">
                <div class="content"></div>
                <div class="date"></div>
                <button class="button" onclick="todoDel(this)">ì‚­ì œ</button>
            </div>
            <div class="TodoItem">
                <input type="checkbox" onchange="onUpdate(this.id)" id="2">
                <div class="content"></div>
                <div class="date"></div>
                <button class="button" onclick="todoDel(this)">ì‚­ì œ</button>
            </div>
        </div>
    </div>
</div>
<script>
    let index=3;
    document.querySelector(".Editor > button").onclick =() =>{ 
        event.preventDefault(); //ì „ì†¡ê¸°ëŠ¥ ë§‰ìŒ 
        let input = document.getElementById("inputContent").value;
        let item = {id:index++,isDone:false,content:input,date:new Date()};//{id:0, isDone:false, content:"React study", date: new Date()}
        mockData.push(item);
       initData(mockData); //í˜¸ì¶œí•œë‹¤.(ë‹¤ì‹œ í™”ë©´ ëœë”ë§) 
     }


     const onUpdate = (targetId)=>{
        //TodoItemì—ì„œ í˜¸ì¶œí•  ë•Œ ì „ë‹¬í•œ id 
     /* mockDataì˜ stateì˜ ê°’ë“¤ ì¤‘ì— targetIdì™€ ì¼ì¹˜í•˜ëŠ” todoitemì˜ isDone ë³€ê²½ 
        mapí•¨ìˆ˜ë¥¼ ì´ìš©í•œë‹¤. mapí•¨ìˆ˜ì˜ ê²°ê³¼ë¥¼ mockDataì— ì €ì¥í•œë‹¤. 
     */ 
    mockData.forEach((item)=>{
        if(item.id===parseInt(targetId)){
            item.isDone = !item.isDone;
        }});
       
         initData(mockData); //í˜¸ì¶œí•œë‹¤.(ë‹¤ì‹œ í™”ë©´ ëœë”ë§)
     }

     const todoDel = (th)=>{ 
     //filter()í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ì‚­ì œí•˜ë ¤ëŠ” ëŒ€ìƒì´ì™¸ì˜ todoë§Œ ì¶”ì¶œí•´ì„œ mockDataì— ë‹´ë“ ë‹¤.
      
      let id = th.parentNode.querySelector("input").getAttribute("id");
      mockData = mockData.filter(item => item.id!=id);
      
     initData(mockData); //í˜¸ì¶œí•œë‹¤.(ë‹¤ì‹œ í™”ë©´ ëœë”ë§) 
    }

</script>
</body>
</html>